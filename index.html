<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jireh Beauty Salon - Facturación</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Playfair Display', serif;
      background-color: #fff8f0;
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      background: #000;
      color: gold;
      padding: 20px;
      text-align: center;
    }
    header img {
      width: 100px;
    }
    h1 {
      margin: 10px 0 0;
    }
    .container {
      padding: 20px;
      max-width: 800px;
      margin: auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background: gold;
      color: black;
      font-weight: bold;
      cursor: pointer;
    }
    table {
      width: 100%;
      margin-top: 10px;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    .footer {
      text-align: center;
      margin-top: 20px;
      font-style: italic;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo_jireh.png" alt="Logo">
    <h1>Jireh Beauty Salon Nails Bar</h1>
    <p>Dios proveerá</p>
  </header>
  <div class="container">
    <label>Nombre del Cliente</label>
    <input type="text" id="cliente">

    <label>Número de Teléfono (+1)</label>
    <input type="tel" id="telefono" placeholder="8090000000">

    <label>Producto o Servicio</label>
    <input type="text" id="producto">

    <label>Precio (DOP)</label>
    <input type="number" id="precio">

    <button onclick="agregarProducto()">Agregar Producto</button>

    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Precio</th>
        </tr>
      </thead>
      <tbody id="listaProductos"></tbody>
    </table>

    <h3>Total: <span id="total">DOP 0</span></h3>
    <button onclick="generarFactura()">Generar Factura PDF</button>
    <button onclick="enviarWhatsApp()">Enviar por WhatsApp</button>
  </div>
  <div class="footer">Gracias por preferirnos. ¡Dios te bendiga y te esperamos pronto!</div>

  <script>
    let productos = []
    let total = 0
    let orden = localStorage.getItem('ultimaOrden') || 1000

    function agregarProducto() {
      const producto = document.getElementById("producto").value
      const precio = parseFloat(document.getElementById("precio").value)

      if (producto && precio) {
        productos.push({ producto, precio })
        total += precio
        actualizarLista()
      }
    }

    function actualizarLista() {
      const lista = document.getElementById("listaProductos")
      lista.innerHTML = ""
      productos.forEach(item => {
        lista.innerHTML += `<tr><td>${item.producto}</td><td>DOP ${item.precio.toFixed(2)}</td></tr>`
      })
      document.getElementById("total").innerText = `DOP ${total.toFixed(2)}`
    }

    function generarFactura() {
      const cliente = document.getElementById("cliente").value
      const { jsPDF } = window.jspdf
      const doc = new jsPDF()

      orden++
      localStorage.setItem('ultimaOrden', orden)

      doc.setFontSize(16)
      doc.text("Jireh Beauty Salon Nails Bar", 20, 20)
      doc.setFontSize(12)
      doc.text("Nombre del Cliente: " + cliente, 20, 30)
      doc.text("Número de Orden: #" + orden, 20, 40)

      let y = 50
      productos.forEach(p => {
        doc.text(`- ${p.producto}: DOP ${p.precio.toFixed(2)}`, 20, y)
        y += 10
      })

      doc.text("TOTAL: DOP " + total.toFixed(2), 20, y + 10)
      doc.text("Gracias por preferirnos. ¡Dios te bendiga!", 20, y + 30)
      doc.save(`Factura_${orden}.pdf`)

      // Guardar historial diario
      let hoy = new Date().toLocaleDateString()
      let historial = JSON.parse(localStorage.getItem('historial') || '{}')
      if (!historial[hoy]) historial[hoy] = []
      historial[hoy].push({ cliente, total, productos, orden })
      localStorage.setItem('historial', JSON.stringify(historial))
    }

    function enviarWhatsApp() {
      const tel = document.getElementById("telefono").value
      const cliente = document.getElementById("cliente").value
      let mensaje = `Hola ${cliente}, gracias por visitar Jireh Beauty Salon. Total: DOP ${total.toFixed(2)}. Orden #${orden}`
      window.open(`https://wa.me/1${tel}?text=${encodeURIComponent(mensaje)}`)
    }
  </script>
</body>
</html>
